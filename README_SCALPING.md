# 단타 자동매매 프로그램 (거래량 급증 전략)

GPT가 거래량 급증 코인을 분석하여 추천하고, 익절 3% / 손절 1.2%에 자동 매도하는 단타 매매 봇입니다.

## 작동 방식

```
1. 거래량 스캔 (60초마다)
   └─> 20개 주요 코인 중 거래량/모멘텀 TOP 5 선정

2. GPT 분석
   └─> 5개 후보 중 최적 종목 1개 추천

3. 자동 매수
   └─> GPT 확신도 60% 이상 & 진입타이밍 "즉시"

4. 포지션 모니터링 (5초마다)
   ├─> 익절: +3% 도달 시 자동 매도
   └─> 손절: -1.2% 도달 시 자동 매도

5. 매도 완료 후 1번으로 반복
```

## 전략 특징

### 수익/손실 비율 (RRR)
- 익절: +3%
- 손절: -1.2%
- **위험 대비 보상 비율: 2.5:1** (유리한 비율)

### 종목 선정 기준
1. **거래량 증가율** - 단기 모멘텀
2. **거래대금** - 충분한 유동성 확보
3. **가격 변동률** - 과열되지 않은 적정 수준
4. **GPT 종합 분석** - 리스크와 기회 균형

### 모니터링 대상 코인
```
BTC, ETH, XRP, ADA, DOT, DOGE, MATIC, SOL, AVAX, LINK
TRX, ETC, BCH, LTC, XLM, ATOM, SAND, MANA, AXS, CHZ
```

## 파일 구조

```
testBIT/
├── scalping_bot.py           # 메인 단타 봇 (이걸 실행!)
├── volume_scanner.py          # 거래량 급증 감지
├── scalping_analyzer.py       # GPT 종목 추천
├── bithumb_api.py            # 빗썸 API
├── .env.example              # 설정 파일 예시
└── README_SCALPING.md        # 이 파일
```

## 실행 방법

### 1. 환경 설정
```bash
# .env 파일 생성
cp .env.example .env

# API 키 입력
# - BITHUMB_API_KEY
# - BITHUMB_SECRET_KEY
# - OPENAI_API_KEY
```

### 2. 프로그램 실행
```bash
python scalping_bot.py
```

### 3. 종료
```
Ctrl + C
```

## 설정 옵션

`.env` 파일에서 수정 가능:

```env
# 1회 투자 금액
INVESTMENT_AMOUNT=50000

# 익절 목표 (%)
PROFIT_TARGET=3.0

# 손절 기준 (%)
STOP_LOSS=-1.2
```

코드 내부 수정:
- `scalping_bot.py:34` - 종목 스캔 주기 (기본 60초)
- `scalping_bot.py:35` - 포지션 모니터링 주기 (기본 5초)
- `volume_scanner.py:18-21` - 모니터링 코인 목록

## 실행 예시

```
================================================================================
🚀 단타 자동매매 봇 시작
================================================================================
투자 금액: 50,000 KRW
수익 목표: +3.0%
손절 기준: -1.2%
종목 스캔 주기: 60초
================================================================================

[15:30:22] 거래량 급증 코인 스캔 중...

📈 단기 모멘텀 TOP 코인
[1] XRP
    현재가: 1,500 KRW
    24시간 가격 변동: +5.2%
    거래대금: 250억원
    모멘텀 스코어: 8.5

🤖 GPT 분석 중...

💡 GPT 추천 결과
추천 코인: XRP
확신도: 85%
진입 타이밍: 즉시
리스크: 중간
이유: 거래량이 급증하면서 안정적인 상승세를 보이고 있습니다...

💰 XRP 매수 시도
현재가: 1,500 KRW
투자 금액: 50,000 KRW

✅ 매수 성공!
   진입가: 1,500 KRW
   수량: 0.03331667 XRP
   목표가: 1,545 KRW (+3%)
   손절가: 1,482 KRW (-1.2%)

포지션 모니터링 시작... (매 5초)

[15:31:45] XRP | 진입: 1,500 → 현재: 1,545 | 수익률: +3.00% | 경과: 83초

🎯 목표 수익률 달성! (+3.0%)
💸 XRP 매도 시도 (사유: 익절)
진입가: 1,500 KRW
현재가: 1,545 KRW
수익률: +3.00%

✅ 매도 완료!
   보유 시간: 83초 (1분)
   예상 수익: +1,500 KRW
================================================================================
```

## 비용 계산

### OpenAI API 비용 (GPT-5-mini)

**시나리오 1: 적극적 매매 (평균 30분 보유)**
- 하루 48회 거래
- 하루 비용: 약 43원
- 월 비용: 약 1,290원

**시나리오 2: 보수적 매매 (평균 2시간 보유)**
- 하루 12회 거래
- 하루 비용: 약 11원
- 월 비용: 약 330원

### 빗썸 수수료
- 매수 수수료: 0.05%
- 매도 수수료: 0.05%
- 50,000원 거래 시: 약 50원

## 위험 관리

### 손익비 (Risk-Reward Ratio)
```
익절: +3.0% = +1,500원
손절: -1.2% = -600원
비율: 2.5:1 (유리)
```

### 승률 필요치
손익분기점 승률: **32%**
(손절 2.5번 = 익절 1번)

### 실전 예시
```
10회 거래 시:
- 4승 6패: +6,000 - 3,600 = +2,400원 (수익)
- 5승 5패: +7,500 - 3,000 = +4,500원 (수익)
```

## 장단점

### 장점
1. **거래량 기반** - 모멘텀 있는 코인 선택
2. **GPT 분석** - 리스크와 기회 균형 평가
3. **유리한 손익비** - 2.5:1 비율
4. **빠른 손절** - -1.2%에서 컷 (큰 손실 방지)
5. **종목 다양화** - 매번 다른 코인 거래 가능

### 주의사항
1. **급격한 변동성** - 암호화폐 특성상 빠른 손절 가능
2. **슬리피지** - 시장가 주문 시 예상가와 차이 발생
3. **수수료** - 잦은 매매 시 수수료 부담
4. **거래량 부족** - 새벽 시간대 유동성 저하

## 최적화 팁

### 1. 손익비 조정
더 안전하게:
```python
self.profit_target = 2.0   # 익절 2%
self.stop_loss = -0.8      # 손절 0.8%
```

더 공격적으로:
```python
self.profit_target = 5.0   # 익절 5%
self.stop_loss = -2.0      # 손절 2%
```

### 2. 투자 금액 조절
```env
INVESTMENT_AMOUNT=30000  # 소액으로 시작
```

### 3. 모니터링 주기 단축
```python
self.monitor_interval = 3  # 3초마다 (더 빠른 반응)
```

### 4. 거래 시간대 제한
```python
# scalping_bot.py의 run() 함수에 추가
import datetime
current_hour = datetime.datetime.now().hour

# 거래량 많은 시간대만 운영 (오전 9시 ~ 자정)
if not (9 <= current_hour < 24):
    print("거래 시간 외")
    time.sleep(300)
    continue
```

## 백테스팅 (테스트 모드)

실제 매매 전에 테스트하려면:

```python
# scalping_bot.py에서 주석 처리
# result = self.bithumb.market_buy(coin, self.investment_amount)

# 대신 이렇게 수정
print(f"[테스트 모드] 매수: {coin}")
result = True  # 가상 매수 성공
```

## 문제 해결

### "거래 기회 없음"이 계속 나올 때
1. `volume_scanner.py:144` - 거래대금 필터 낮추기
   ```python
   if acc_trade_value < 50000000:  # 5천만원으로 낮춤
   ```

2. GPT 확신도 기준 낮추기
   ```python
   if recommendation['confidence'] >= 50:  # 50%로 낮춤
   ```

### 매수/매도가 실패할 때
1. 빗썸 API 키 권한 확인
2. 잔고 확인 (KRW 부족 / 코인 부족)
3. 최소 주문 금액 확인 (코인마다 다름)

### 포지션이 오래 유지될 때
- 변동성이 적은 구간
- 손절/익절 범위 조정 고려
- 시간 제한 추가 검토

## 추가 기능 아이디어

1. **트레일링 스탑** - 익절 후 추가 상승 시 계속 보유
2. **시간 손절** - 일정 시간 후 강제 매도
3. **멀티 포지션** - 여러 코인 동시 보유
4. **텔레그램 알림** - 매매 시 알림 발송
5. **거래 로그** - CSV 파일로 기록

---

## 면책 조항

이 프로그램은 교육 목적으로 제작되었습니다.
암호화폐 투자는 고위험 자산이며, 모든 투자 결과에 대한 책임은 사용자에게 있습니다.
충분한 테스트 후 소액으로 시작하시기 바랍니다.
